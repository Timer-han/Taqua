# Backend taqwa app

## Project structure
- config: конфиги приложения
- internal: основная логика приложения по чистой архитектуре
- migrations: миграции для mongo в json
- pkg: всякие файлы, которые можно задействовать в других сервисах по типу констант и тд

## Information
Главная идея тут это деление логики по слоям чистой архитектуры(более подробно можно узнать в инете). В папке internal есть директории которые +- отвечают за них
- delivery: слой, где принимаются внешние запросы. Это может быть как команды введеные в боте, так и запросы через фронтенд. Для удобства они разделены на подпапки: bot и http соответственно.
- service: слой бизнес логики. Тут надо производить все вычисления, валидировать данные и подавать запросы в другие возможно сервисы. 
- storage: слой хранения данных. Описаны методы для добавления/удаления/обновления данных и тд. Данный слой должен просто принять данные и сохранить их в базе, не более.

Соответственно запросы идут в такой последовательности: user -> delivery -> service -> storage -> service -> delivery -> user. То есть все доходит до базы, как то с ней взаимодействует и возвращает результат обратно пользователю.

Так же помимо этих директорий в internal есть еще models. В ней хранятся классы сущностей с которыми оперируем.

### Создание пользователя
При вводе пользователем команды /start, нам нужно сохранить информацию об этом пользователе в базе(коллекция users). При этом, это может быть уже старый пользователь, но который решил еще раз нажать /start. Для новых пользователей отображается формочка с выбором уровня знаний(которую надо додумать). А для старых, показываем просто инфу о ботике

### Предложение вопроса через бота
Если пользователь вводит команду /suggest, то его проводим по флоу добавления вопроса, выпрашивая у него вопрос, ответы на него и корректный. На самом деле не очень удобная штука, поэтому легче это сделать через сайт. После получения всей инфы, вопрос сохраняется в базе(коллекция suggest). Так же для вопроса подтягивается информация о пользователе, чтобы можно было увидеть а кем вообще задан вопрос.

### Предложение вопроса на сайте
Тут уже все данные приходят от фронта разом и их просто надо сохранить в базе. Прелесть чистой архитектуры в том, что для предыдущего и данного пункта мы изменили только слой delivery. Остальные слоя идентичны и не надо писать двойной код. Единственная проблема на данный момент, никак не идентифицируется пользователь, который задал вопрос через сайт. Для данного случая в базе есть пользователь default с telegram_id=-1. Соответсвенно все вопросы через сайт пока что считаются заданными этим пользователем

###

###


### Тут свалка данных, нужная для настройки бота в телеграмме
bot commands(нужно для настройки в telegram)
```
start - начать пользование
help - руководство
faq - частые вопросы
feedback - обратная связь
```